{"version":3,"file":"bscroll.min.js","sources":["bscroll.min.js"],"sourcesContent":["\"use strict\";\n\nvar _betterScroll = _interopRequireDefault(require(\"better-scroll\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n// import './main.less'\n(function ($) {\n  $.fn.selectScroll = function (options) {\n    var defaultSettings = {\n      // texts\n      title: 'Pick An Option',\n      // 1级数据\n      // data: [],\n      // 多级数据\n      data: [],\n      // buttons\n      cancelTxt: 'cancel',\n      cancelClass: '',\n      confirmTxt: 'confirm',\n      confirmClass: '',\n      cancel: null,\n      confirm: null,\n      // controls\n      selectedIndex: [0, 0, 0],\n      // class\n      \"class\": ''\n    };\n    this.settings = $.extend({}, defaultSettings, options); // option value of maxLevel： 1、2\n    // this.settings.maxLevel = this.settings.maxLevel < 0 ? 1 : this.settings.maxLevel > 2 ? 2 : this.settings.maxLevel\n\n    this.settings.maxLevel = this.settings.data.length > 3 ? 3 : this.settings.data.length > 0 ? this.settings.data.length : 1;\n\n    function getWheelHtml(len) {\n      var tempWheelHtml = '';\n\n      for (var i = 0; i < len; i++) {\n        tempWheelHtml += \"<div class=\\\"wheel\\\">\\n                                    <ul class=\\\"wheel-scroll\\\">\\n                                    </ul>\\n                                </div>\\n                                \";\n      }\n\n      return tempWheelHtml;\n    }\n\n    var wheelHtml = getWheelHtml.call(this, this.settings.maxLevel);\n    var defaultHtml = \"<div class=\\\"picker\\\">\\n            <div class=\\\"picker-panel\\\">\\n                <div class=\\\"picker-choose border-bottom-1px\\\">\\n                    <span class=\\\"cancel\\\">\" + this.settings.cancelTxt + \"</span>\\n                    <span class=\\\"confirm\\\">\" + this.settings.confirmTxt + \"</span>\\n                    <h1 class=\\\"picker-title\\\">\" + this.settings.title + \"</h1>\\n                </div>\\n                <div class=\\\"picker-content\\\">\\n                    <div class=\\\"mask-top border-bottom-1px\\\"></div>\\n                    <div class=\\\"mask-bottom border-top-1px\\\"></div>\\n                    <div class=\\\"wheel-wrapper\\\">\" + wheelHtml + \"</div>\\n                </div>\\n                <div class=\\\"picker-footer\\\"></div>\\n            </div>\\n        </div>\";\n    var $self = this;\n    $self.$wheel = []; // 存放select-scroll对象的数组\n\n    $self.isEmpty = function () {\n      return !$self.settings.data.length;\n    };\n\n    $self.init = function () {\n      if ($self.next('.picker').length) {\n        $self.show();\n      } else {\n        $self.after(defaultHtml); // add class\n\n        if ($self.settings[\"class\"] != '') {\n          $self.next('.picker').addClass($self.settings[\"class\"]);\n        }\n\n        for (var i = 0; i < $self.settings.maxLevel; i++) {\n          $self._createWheel(i);\n        }\n      }\n    }; // confirm\n\n\n    $self.confirm = function (e) {\n      // console.log('点击了confirm')\n      var selectObj = $self.getData();\n      $self.hide();\n      $self.bindSelectedIndex();\n\n      if (e.data.callback) {\n        e.data.callback(selectObj);\n        return;\n      }\n\n      if (selectObj.length < 1) {\n        return;\n      }\n\n      var text = '';\n\n      if (selectObj.length === 1) {\n        text = selectObj[0].text;\n      } else {\n        Object.keys(selectObj).reduce(function (prev, cur) {\n          text += selectObj[prev].text + ',' + selectObj[cur].text;\n          return cur;\n        });\n      }\n\n      $self.html(text);\n    }; // cancel\n\n\n    $self.cancel = function () {\n      console.log('点击了cancel');\n      $self.hide();\n    }; // show selectScroll\n\n\n    $self.show = function () {\n      console.log('这里是show函数');\n      $self.$picker = $self.next('.picker');\n      $self.$picker.show();\n      $self.$picker.find('.picker-panel').attr('class', 'picker-panel').addClass('up');\n    }; // hide\n\n\n    $self.hide = function () {\n      console.log('这里是hide');\n\n      if ($self.$picker) {\n        var $pannel = $self.$picker.find('.picker-panel');\n        $pannel.attr('class', 'picker-panel').addClass('down');\n        var timer = setTimeout(function () {\n          $self.$picker.hide();\n          clearTimeout(timer);\n        }, 300);\n      }\n    }; // destroy\n    // $self._destroy = function() {\n    //     console.log('这里是_destroy')\n    //     if ($self.$wheel[index]) {\n    //         $self.$wheel[index].disable()\n    //         $self.$wheel[index].destroy()\n    //         console.log('这里是_destroy里的$self.$wheel[index]')\n    //     }\n    //     if ($self.$picker) {\n    //         $self.$picker.remove()\n    //         console.log('这里是_destroy里的$self.picker')\n    //     }\n    // }\n    // setData\n\n\n    $self.setData = function () {};\n\n    $self.getData = function () {\n      var tempArr = [];\n\n      if (!$self.isEmpty()) {\n        for (var i = 0; i < $self.$wheel.length; i++) {\n          tempArr.push($self.settings.data[i][$self.$wheel[i].getSelectedIndex()]);\n        }\n\n        return tempArr;\n      } else {\n        return [];\n      }\n    }; // index of data\n\n\n    $self.setSelectedIndex = function (index) {\n      $self.bindSelectedIndex(index);\n    }; // update selectedIndex\n\n\n    $self.updateSelectedIndex = function () {\n      console.log('这是updateSelectedIndex:'); // autofill $self.settings.selectedIndex\n\n      var i = $self.settings.selectedIndex.length;\n\n      for (i; i < $self.settings.maxLevel; i++) {\n        $self.settings.selectedIndex[i] = 0;\n      } // if  $self  has attr data-selectIndex\n\n\n      if ($self.attr('data-selectindex')) {\n        $self.settings.selectedIndex = $self.attr('data-selectindex').split(',');\n      }\n    }; // set attr data-selectIndex for $self\n\n\n    $self.bindSelectedIndex = function () {\n      var selectedIndex = [];\n\n      for (var i = 0; i < $self.$wheel.length; i++) {\n        selectedIndex.push($self.$wheel[i].getSelectedIndex());\n      } // selectedIndex must have value\n\n\n      if (selectedIndex.lenght) {\n        $self.attr('data-selectIndex', selectedIndex);\n      }\n    }; // unbind buttons events\n\n\n    $self.detachButtonEvents = function () {\n      console.log('这里是detachButtonEvents');\n      $self.$confirm.unbind();\n      $self.$cancel.unbind();\n    }; // attach buttons events\n\n\n    $self.attachButtonEvents = function () {\n      console.log('这里是attachButtonEvents');\n      $self.$confirm = $self.$picker.find('.confirm').addClass($self.settings.confirmClass);\n      $self.$confirm.bind('click', {\n        callback: $self.settings.confirm\n      }, $self.confirm);\n      $self.$cancel = $self.$picker.find('.cancel').addClass($self.settings.cancelClass);\n      $self.$cancel.bind('click', {\n        callback: $self.settings.cancel\n      }, $self.cancel);\n    };\n\n    $self.scrollTo = function (index) {\n      console.log('这是scrollTo');\n      $self.$wheel[index].wheelTo(index);\n    };\n\n    $self._createWheel = function (index) {\n      $self._createHtml(index); // 运行3次\n      // updateSelectedIndex\n\n\n      $self.updateSelectedIndex();\n      var wheels = document.querySelectorAll('.wheel'); // creat wheel\n\n      $self.$wheel[index] = new _betterScroll[\"default\"](wheels[index], {\n        wheel: {\n          selectedIndex: $self.settings.selectedIndex[index],\n          wheelWrapperClass: 'wheel-scroll',\n          wheelItemClass: 'wheel-item'\n        },\n        probeType: 3\n      });\n\n      if (index === $self.settings.maxLevel - 1) {\n        console.log('运行了几次函数绑定'); // get only dom $picker\n\n        $self.show();\n        $self.attachButtonEvents();\n      }\n    };\n\n    $self._createHtml = function (index) {\n      var liHtml = '';\n      var dataLen = this.settings.data.length ? this.settings.data[index].length : 0;\n\n      for (var i = 0; i < dataLen; i++) {\n        liHtml += \"<li class=\\\"wheel-item\\\" data-id=\\\"\" + this.settings.data[index][i].id + \"\\\">\" + this.settings.data[index][i].text + \"</li>\";\n      }\n\n      $('.wheel-scroll').eq(index).append(liHtml);\n    };\n\n    $self.init();\n  };\n})(jQuery);"],"names":["_betterScroll","_interopRequireDefault","require","obj","__esModule","default","$","fn","selectScroll","options","this","settings","extend","title","data","cancelTxt","cancelClass","confirmTxt","confirmClass","cancel","confirm","selectedIndex","class","maxLevel","length","wheelHtml","len","tempWheelHtml","i","call","defaultHtml","$self","$wheel","isEmpty","init","next","show","after","addClass","_createWheel","e","text","selectObj","getData","hide","bindSelectedIndex","callback","Object","keys","reduce","prev","cur","html","console","log","$picker","find","attr","timer","setTimeout","clearTimeout","setData","tempArr","push","getSelectedIndex","setSelectedIndex","index","updateSelectedIndex","split","lenght","detachButtonEvents","$confirm","unbind","$cancel","attachButtonEvents","bind","scrollTo","wheelTo","_createHtml","wheels","document","querySelectorAll","wheel","wheelWrapperClass","wheelItemClass","probeType","liHtml","dataLen","id","eq","append","jQuery"],"mappings":"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"}